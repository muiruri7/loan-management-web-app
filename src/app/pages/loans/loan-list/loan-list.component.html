<div class="loan-list">
  <h2>Loans</h2>

  <div class="search-container">
    <input
      type="text"
      [(ngModel)]="searchTerm"
      (input)="filterLoans()"
      placeholder="🔍 Search loans..."
    />
  </div>

  <button class="btn-add" routerLink="/loans/add">➕ Add Loan</button>

  <div *ngIf="errorMessage" class="error">{{ errorMessage }}</div>

  <table class="loan-table">
    <thead>
      <tr>
        <th (click)="sortLoans('borrower')">
          Borrower {{ sortColumn === 'borrower' ? (sortAscending ? '🔼' : '🔽') : '' }}
        </th>
        <th (click)="sortLoans('amount')">
          Amount {{ sortColumn === 'amount' ? (sortAscending ? '🔼' : '🔽') : '' }}
        </th>
        <th (click)="sortLoans('term')">
          Term {{ sortColumn === 'term' ? (sortAscending ? '🔼' : '🔽') : '' }}
        </th>
        <th (click)="sortLoans('repaymentFrequency')">
          Repayment Frequency {{ sortColumn === 'repaymentFrequency' ? (sortAscending ? '🔼' : '🔽') : '' }}
        </th>
        <th (click)="sortLoans('startDate')">
          Start Date {{ sortColumn === 'startDate' ? (sortAscending ? '🔼' : '🔽') : '' }}
        </th>
        <th (click)="sortLoans('endDate')">
          End Date {{ sortColumn === 'endDate' ? (sortAscending ? '🔼' : '🔽') : '' }}
        </th>
        <th (click)="sortLoans('status')">
          Status {{ sortColumn === 'status' ? (sortAscending ? '🔼' : '🔽') : '' }}
        </th>
        <th>Actions</th>
      </tr>
    </thead>
    <tbody>
      <tr *ngFor="let loan of filteredLoans">
        <td>{{ loan.borrower }}</td>
        <td>{{ loan.amount | currency }}</td>
        <td>{{ loan.term }} days</td>
        <td>{{ loan.repaymentFrequency }}</td>
        <td>{{ loan.startDate | date }}</td>
        <td>{{ loan.endDate | date }}</td>
        <td>{{ loan.status }}</td>
        <td>
          <button class="btn-edit" (click)="editLoan(loan.id)">✏️ Edit</button>
          <button class="btn-delete" (click)="deleteLoan(loan.id)">🗑 Delete</button>
        </td>
      </tr>
    </tbody>
  </table>
</div>
